(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-068aa3f1"],{"1f27":function(t,e,a){"use strict";var n=a("9efd"),o="/api/admin/menus",r={listAll:function(){return Object(n["a"])({url:o,method:"get"})},listTree:function(){return Object(n["a"])({url:"".concat(o,"/tree_view"),method:"get"})},create:function(t){return Object(n["a"])({url:o,data:t,method:"post"})},delete:function(t){return Object(n["a"])({url:"".concat(o,"/").concat(t),method:"delete"})},get:function(t){return Object(n["a"])({url:"".concat(o,"/").concat(t),method:"get"})},update:function(t,e){return Object(n["a"])({url:"".concat(o,"/").concat(t),data:e,method:"put"})},listTeams:function(){return Object(n["a"])({url:"".concat(o,"/teams"),method:"get"})}};e["a"]=r},3993:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-drawer",{attrs:{title:t.title,width:t.isMobile()?"100%":t.drawerWidth,closable:"",visible:t.visible,destroyOnClose:""},on:{close:t.onClose}},[a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-input-search",{attrs:{placeholder:"搜索附件",enterButton:""},on:{search:function(e){return t.handleQuery()}},model:{value:t.queryParam.keyword,callback:function(e){t.$set(t.queryParam,"keyword",e)},expression:"queryParam.keyword"}})],1),a("a-divider"),a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-skeleton",{attrs:{active:"",loading:t.skeletonLoading,paragraph:{rows:18}}},[a("a-col",{attrs:{span:24}},[0==t.attachments.length?a("a-empty"):t._l(t.attachments,(function(e,n){return a("div",{key:n,staticClass:"attach-item",on:{click:function(a){return t.handleSelectAttachment(e)}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.handleJudgeMediaType(e),expression:"!handleJudgeMediaType(item)"}]},[t._v("当前格式不支持预览")]),a("img",{directives:[{name:"show",rawName:"v-show",value:t.handleJudgeMediaType(e),expression:"handleJudgeMediaType(item)"}],attrs:{src:e.thumbPath,loading:"lazy"}})])}))],2)],1)],1),a("a-divider"),a("div",{staticClass:"page-wrapper"},[a("a-pagination",{attrs:{current:t.pagination.page,total:t.pagination.total,defaultPageSize:t.pagination.size},on:{change:t.handlePaginationChange}})],1),a("a-divider",{staticClass:"divider-transparent"}),a("div",{staticClass:"bottom-control"},[t.isChooseAvatar?a("a-button",{staticStyle:{marginRight:"8px"},attrs:{type:"dashed"},on:{click:t.handleSelectGravatar}},[t._v("使用 Gravatar")]):t._e(),a("a-button",{attrs:{type:"primary"},on:{click:t.handleShowUploadModal}},[t._v("上传附件")])],1)],1),a("a-modal",{attrs:{title:"上传附件",footer:null,afterClose:t.onUploadClose,destroyOnClose:""},model:{value:t.uploadVisible,callback:function(e){t.uploadVisible=e},expression:"uploadVisible"}},[a("FilePondUpload",{ref:"upload",attrs:{uploadHandler:t.uploadHandler}})],1)],1)},o=[],r=(a("28a5"),a("55dd"),a("c5f6"),a("ac0d")),i=a("a796"),l={name:"AttachmentSelectDrawer",mixins:[r["a"],r["b"]],model:{prop:"visible",event:"close"},props:{visible:{type:Boolean,required:!1,default:!1},drawerWidth:{type:Number,required:!1,default:480},title:{type:String,required:!1,default:"选择附件"},isChooseAvatar:{type:Boolean,required:!1,default:!1}},data:function(){return{uploadVisible:!1,skeletonLoading:!0,pagination:{page:1,size:12,sort:null,total:1},queryParam:{page:0,size:12,sort:null,keyword:null},attachments:[],uploadHandler:i["a"].upload}},watch:{visible:function(t,e){t&&(this.loadSkeleton(),this.loadAttachments())}},methods:{loadSkeleton:function(){var t=this;this.skeletonLoading=!0,setTimeout((function(){t.skeletonLoading=!1}),500)},handleShowUploadModal:function(){this.uploadVisible=!0},loadAttachments:function(){var t=this;this.queryParam.page=this.pagination.page-1,this.queryParam.size=this.pagination.size,this.queryParam.sort=this.pagination.sort,i["a"].query(this.queryParam).then((function(e){t.attachments=e.data.data.content,t.pagination.total=e.data.data.total}))},handleQuery:function(){this.handlePaginationChange(1,this.pagination.size)},handleSelectAttachment:function(t){this.$emit("listenToSelect",t)},handleSelectGravatar:function(){this.$emit("listenToSelectGravatar")},handlePaginationChange:function(t,e){this.pagination.page=t,this.pagination.size=e,this.loadAttachments()},onUploadClose:function(){this.$refs.upload.handleClearFileList(),this.loadSkeleton(),this.handlePaginationChange(1,this.pagination.size)},handleJudgeMediaType:function(t){var e=t.mediaType;if(e){var a=e.split("/")[0];return"image"===a}return!1},onClose:function(){this.$emit("close",!1)}}},c=l,s=a("2877"),d=Object(s["a"])(c,n,o,!1,null,null,null);e["a"]=d.exports},"7e89":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{attrs:{gutter:12}},[a("a-col",{style:{"padding-bottom":"12px"},attrs:{xl:10,lg:10,md:10,sm:24,xs:24}},[a("a-card",{attrs:{title:t.title,bodyStyle:{padding:"16px"}}},[a("a-form",{attrs:{layout:"horizontal"}},[a("a-form-item",{attrs:{label:"名称：",help:"* 页面上所显示的名称"}},[a("a-input",{model:{value:t.categoryToCreate.name,callback:function(e){t.$set(t.categoryToCreate,"name",e)},expression:"categoryToCreate.name"}})],1),a("a-form-item",{attrs:{label:"别名：",help:"* 一般为单个分类页面的标识，最好为英文"}},[a("a-input",{model:{value:t.categoryToCreate.slug,callback:function(e){t.$set(t.categoryToCreate,"slug",e)},expression:"categoryToCreate.slug"}})],1),a("a-form-item",{attrs:{label:"上级目录："}},[a("category-select-tree",{attrs:{categories:t.categories},model:{value:t.categoryToCreate.parentId,callback:function(e){t.$set(t.categoryToCreate,"parentId",e)},expression:"categoryToCreate.parentId"}})],1),a("a-form-item",{attrs:{label:"封面图：",help:"* 在分类页面可展示，需要主题支持"}},[a("a-input",{model:{value:t.categoryToCreate.thumbnail,callback:function(e){t.$set(t.categoryToCreate,"thumbnail",e)},expression:"categoryToCreate.thumbnail"}},[a("a",{attrs:{slot:"addonAfter",href:"javascript:void(0);"},on:{click:function(e){t.thumbnailDrawerVisible=!0}},slot:"addonAfter"},[a("a-icon",{attrs:{type:"picture"}})],1)])],1),a("a-form-item",{attrs:{label:"描述：",help:"* 分类描述，部分主题可显示"}},[a("a-input",{attrs:{type:"textarea",autoSize:{minRows:3}},model:{value:t.categoryToCreate.description,callback:function(e){t.$set(t.categoryToCreate,"description",e)},expression:"categoryToCreate.description"}})],1),a("a-form-item",["create"===t.formType?a("a-button",{attrs:{type:"primary"},on:{click:t.handleSaveClick}},[t._v("保存")]):a("a-button-group",[a("a-button",{attrs:{type:"primary"},on:{click:t.handleSaveClick}},[t._v("更新")]),"update"===t.formType?a("a-button",{attrs:{type:"dashed"},on:{click:t.handleAddCategory}},[t._v("返回添加")]):t._e()],1)],1)],1)],1)],1),a("a-col",{style:{"padding-bottom":"1rem"},attrs:{xl:14,lg:14,md:14,sm:24,xs:24}},[a("a-card",{attrs:{title:"分类列表",bodyStyle:{padding:"16px"}}},[t.isMobile()?a("a-list",{attrs:{itemLayout:"vertical",size:"large",pagination:!1,dataSource:t.categories,loading:t.loading},scopedSlots:t._u([{key:"renderItem",fn:function(e,n){return a("a-list-item",{key:n},[a("template",{slot:"actions"},[a("span",[a("a-icon",{attrs:{type:"form"}}),t._v("\n                "+t._s(e.postCount)+"\n              ")],1),a("a-dropdown",{attrs:{placement:"topLeft",trigger:["click"]}},[a("span",[a("a-icon",{attrs:{type:"bars"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.handleEditCategory(e)}}},[t._v("编辑")])]),a("a-menu-item",[a("a-popconfirm",{attrs:{title:"你确定要添加【"+e.name+"】到菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(a){return t.handleCategoryToMenu(e)}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("添加到菜单")])])],1),a("a-menu-item",[a("a-popconfirm",{attrs:{title:"你确定要删除【"+e.name+"】分类？",okText:"确定",cancelText:"取消"},on:{confirm:function(a){return t.handleDeleteCategory(e.id)}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("删除")])])],1)],1)],1)],1),a("a-list-item-meta",[a("template",{slot:"description"},[t._v("\n                "+t._s(e.slug)+"\n              ")]),a("span",{staticStyle:{"max-width":"300px",display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{slot:"title"},slot:"title"},[t._v("\n                "+t._s(e.name)+"\n              ")])],2),a("span",[t._v("\n              "+t._s(e.description)+"\n            ")])],2)}}],null,!1,77786839)}):a("a-table",{attrs:{columns:t.columns,dataSource:t.categories,rowKey:function(t){return t.id},loading:t.loading,scrollToFirstRowOnChange:!0},scopedSlots:t._u([{key:"postCount",fn:function(e,n){return a("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.handleQueryCategoryPosts(n)}}},[a("a-badge",{attrs:{count:n.postCount,numberStyle:{backgroundColor:"#00e0ff"},showZero:!0,overflowCount:9999}})],1)}},{key:"action",fn:function(e,n){return a("span",{},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditCategory(n)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{staticClass:"ant-dropdown-link",attrs:{href:"javascript:void(0);"}},[t._v("更多")]),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a-popconfirm",{attrs:{title:"你确定要添加【"+n.name+"】到菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleCategoryToMenu(n)}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("添加到菜单")])])],1),a("a-menu-item",{key:"2"},[a("a-popconfirm",{attrs:{title:"你确定要删除【"+n.name+"】分类？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleDeleteCategory(n.id)}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("删除")])])],1)],1)],1)],1)}}])})],1)],1)],1),a("AttachmentSelectDrawer",{attrs:{title:"选择封面图"},on:{listenToSelect:t.handleSelectThumbnail},model:{value:t.thumbnailDrawerVisible,callback:function(e){t.thumbnailDrawerVisible=e},expression:"thumbnailDrawerVisible"}})],1)},o=[],r=(a("7f7f"),a("ac0d")),i=a("fa25"),l=a("3993"),c=a("c405"),s=a("1f27"),d=[{title:"名称",ellipsis:!0,dataIndex:"name"},{title:"别名",ellipsis:!0,dataIndex:"slug"},{title:"描述",ellipsis:!0,dataIndex:"description"},{title:"文章数",dataIndex:"postCount",scopedSlots:{customRender:"postCount"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],u={components:{CategorySelectTree:i["a"],AttachmentSelectDrawer:l["a"]},mixins:[r["a"],r["b"]],data:function(){return{formType:"create",categories:[],categoryToCreate:{},thumbnailDrawerVisible:!1,menu:{},loading:!1,columns:d}},computed:{title:function(){return this.categoryToCreate.id?"修改分类":"添加分类"}},created:function(){this.loadCategories()},methods:{loadCategories:function(){var t=this;this.loading=!0,c["a"].listAll(!0).then((function(e){t.categories=e.data.data,t.loading=!1}))},handleSaveClick:function(){this.createOrUpdateCategory()},handleAddCategory:function(){this.formType="create",this.categoryToCreate={}},handleEditCategory:function(t){this.categoryToCreate=t,this.formType="update"},handleDeleteCategory:function(t){var e=this;c["a"].delete(t).then((function(t){e.$message.success("删除成功！"),e.loadCategories(),e.handleAddCategory()}))},createOrUpdateCategory:function(){var t=this;this.categoryToCreate.name?(this.categoryToCreate.id?c["a"].update(this.categoryToCreate.id,this.categoryToCreate).then((function(e){t.$message.success("更新成功！"),t.loadCategories()})):c["a"].create(this.categoryToCreate).then((function(e){t.$message.success("保存成功！"),t.loadCategories()})),this.handleAddCategory()):this.$notification["error"]({message:"提示",description:"分类名称不能为空！"})},handleCategoryToMenu:function(t){var e=this;this.menu["name"]=t.name,this.menu["url"]="".concat(t.fullPath),s["a"].create(this.menu).then((function(t){e.$message.success("添加到菜单成功！"),e.menu={}}))},handleSelectThumbnail:function(t){this.$set(this.categoryToCreate,"thumbnail",encodeURI(t.path)),this.thumbnailDrawerVisible=!1},handleQueryCategoryPosts:function(t){this.$router.push({name:"PostList",query:{categoryId:t.id}})}}},p=u,h=a("2877"),m=Object(h["a"])(p,n,o,!1,null,null,null);e["default"]=m.exports},a796:function(t,e,a){"use strict";var n=a("bc3a"),o=a.n(n),r=a("9efd"),i="/api/admin/attachments",l={query:function(t){return Object(r["a"])({url:i,params:t,method:"get"})},get:function(t){return Object(r["a"])({url:"".concat(i,"/").concat(t),method:"get"})},delete:function(t){return Object(r["a"])({url:"".concat(i,"/").concat(t),method:"delete"})},deleteInBatch:function(t){return Object(r["a"])({url:"".concat(i),method:"delete",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})},update:function(t,e){return Object(r["a"])({url:"".concat(i,"/").concat(t),method:"put",data:e})},getMediaTypes:function(){return Object(r["a"])({url:"".concat(i,"/media_types"),method:"get"})},getTypes:function(){return Object(r["a"])({url:"".concat(i,"/types"),method:"get"})}};l.CancelToken=o.a.CancelToken,l.isCancel=o.a.isCancel,l.upload=function(t,e,a){return Object(r["a"])({url:"".concat(i,"/upload"),timeout:864e4,data:t,onUploadProgress:e,cancelToken:a,method:"post"})},l.uploads=function(t,e,a){return Object(r["a"])({url:"".concat(i,"/uploads"),timeout:864e4,data:t,onUploadProgress:e,cancelToken:a,method:"post"})},l.type={LOCAL:{type:"LOCAL",text:"本地"},SMMS:{type:"SMMS",text:"SM.MS"},UPOSS:{type:"UPOSS",text:"又拍云"},QINIUOSS:{type:"QINIUOSS",text:"七牛云"},ALIOSS:{type:"ALIOSS",text:"阿里云"},BAIDUBOS:{type:"BAIDUBOS",text:"百度云"},TENCENTCOS:{type:"TENCENTCOS",text:"腾讯云"},HUAWEIOBS:{type:"HUAWEIOBS",text:"华为云"}},e["a"]=l},c405:function(t,e,a){"use strict";a("7f7f"),a("ac6a");var n=a("9efd"),o="/api/admin/categories",r={};function i(t,e){e.forEach((function(e){t.key===e.parentId&&(t.children||(t.children=[]),t.children.push({key:e.id,title:e.name,isLeaf:!1}))})),t.children?t.children.forEach((function(t){return i(t,e)})):t.isLeaf=!0}r.listAll=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(n["a"])({url:"".concat(o),params:{more:t},method:"get"})},r.listTree=function(){return Object(n["a"])({url:"".concat(o,"/tree_view"),method:"get"})},r.create=function(t){return Object(n["a"])({url:o,data:t,method:"post"})},r.delete=function(t){return Object(n["a"])({url:"".concat(o,"/").concat(t),method:"delete"})},r.get=function(t){return Object(n["a"])({url:"".concat(o,"/").concat(t),method:"get"})},r.update=function(t,e){return Object(n["a"])({url:"".concat(o,"/").concat(t),data:e,method:"put"})},r.concreteTree=function(t){var e={key:0,title:"top",children:[]};return i(e,t),e.children},e["a"]=r},fa25:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-tree-select",{attrs:{treeData:t.categoryTreeData,placeholder:"请选择上级目录，默认为顶级目录",treeDefaultExpandAll:"",treeDataSimpleMode:!0,allowClear:!0,value:t.categoryIdString},on:{change:t.handleSelectionChange}})},o=[],r=(a("6b54"),a("7f7f"),a("c5f6"),{name:"CategorySelectTree",model:{prop:"categoryId",event:"change"},props:{categoryId:{type:Number,required:!0,default:0},categories:{type:Array,required:!1,default:function(){return[]}}},computed:{categoryTreeData:function(){return this.categories.map((function(t){return{id:t.id,title:t.name,value:t.id.toString(),pId:t.parentId}}))},categoryIdString:function(){return this.categoryId.toString()}},methods:{handleSelectionChange:function(t,e,a){this.$log.debug("value: ",t),this.$log.debug("label: ",e),this.$log.debug("extra: ",a),this.$emit("change",t?parseInt(t):0)}}}),i=r,l=a("2877"),c=Object(l["a"])(i,n,o,!1,null,null,null);e["a"]=c.exports}}]);